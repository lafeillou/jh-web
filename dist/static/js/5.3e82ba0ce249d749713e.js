webpackJsonp([5],{"gP/1":function(e,t){},lome:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("FrmM"),a=s("5eyz"),r={props:{caseObj:{type:Object,required:!0}},name:"step6",data:function(){return{msg:"step6",previewSrc:"",wsHtml:"",fullscreenLoading:!1}},mounted:function(){var e=this;this.previewSrc="/api/4static/generated/ws/preview?caseNumber="+this.caseObj.caseNumber,this.fullscreenLoading=!0,Object(a.h)({method:"get",url:this.previewSrc,headers:{contentType:"text/html;charset=UTF-8"},data:this.contentForm}).then(function(t){e.fullscreenLoading=!1,e.wsHtml=t.data}).catch(function(t){e.fullscreenLoading=!1})},methods:{handleClick:function(e){"exportsWORD"===e?this.exportsWord():"exportsPPT"===e&&this.exportsPPT()},exportsWord:function(){var e=this;this.fullscreenLoading=!0,Object(n.p)({}).then(function(t){if("200"===t.data.code){if(e.fullscreenLoading=!1,t.data.data.wordExist)return t.data.data.wordExist;e.$message({type:"warning",message:"没有配置该模板"})}else e.fullscreenLoading=!1,e.$message({type:"warning",message:t.data.msg})}).then(function(t){t&&(e.fullscreenLoading=!1,window.location="/api/4static/generated/ws/export?caseNumber="+e.caseObj.caseNumber+"&templateType=doc")}).catch(function(t){e.fullscreenLoading=!1})},exportsPPT:function(){var e=this;this.fullscreenLoading=!0,Object(n.p)({}).then(function(t){if("200"===t.data.code){if(e.fullscreenLoading=!1,t.data.data.pptExist)return t.data.data.pptExist;e.$message({type:"warning",message:"没有配置该模板"})}else e.fullscreenLoading=!1,e.$message({type:"warning",message:t.data.msg})}).then(function(t){t&&(e.fullscreenLoading=!1,window.location="/api/4static/generated/ws/export?caseNumber="+e.caseObj.caseNumber+"&templateType=ppt")}).catch(function(t){e.fullscreenLoading=!1})},done:function(){this.$confirm("是否退出案件?","",{confirmButtonText:"退出",cancelButtonText:"取消",center:!0,showClose:!1}).then(function(){eDossier&&eDossier.close()})},prev:function(){this.$router.push({name:"step5"})}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullscreenLoading,expression:"fullscreenLoading"}],staticClass:"step-wrap",attrs:{id:"step6"}},[e._m(0),e._v(" "),s("div",{staticClass:"step-body-without-tabs-wrap step-body-without-tabs-wrap2",staticStyle:{padding:"0"}},[s("div",{attrs:{id:"generatedWs"},domProps:{innerHTML:e._s(e.wsHtml)}})]),e._v(" "),s("div",{staticClass:"step-footer-wrap"},[s("el-dropdown",{staticClass:"el-dropdown-step6",attrs:{placement:"100, 100"},on:{command:e.handleClick}},[s("el-button",{attrs:{size:"small"}},[e._v("\n        导出"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"el-dropdown-menu-step6",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"exportsWORD"}},[e._v("Word格式")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"exportsPPT"}},[e._v("PPT格式")])],1)],1),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.prev}},[e._v("上一步")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.done}},[e._v("完成")])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"step-header-wrap"},[t("h2",{staticStyle:{"background-color":"white"}},[this._v("生成文书")])])}]};var i=s("C7Lr")(r,o,!1,function(e){s("gP/1")},null,null);t.default=i.exports}});
//# sourceMappingURL=5.3e82ba0ce249d749713e.js.map