webpackJsonp([0],{"1J5t":function(t,e,s){s("Gquc"),s("IsPG"),s("A1pn"),s("oltR"),s("V7Pz"),s("DG01"),s("toDE"),t.exports=s("AKd3").Set},"27tL":function(t,e,s){var n=s("8Nvm");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},"4HpA":function(t,e,s){"use strict";var n=s("C02x"),i=s("FITv"),a=s("DVkV"),o=s("BRDz"),r=s("bHZz"),c=s("bodH"),u=s("k/7E"),l=s("t8DS"),d=s("8Nvm"),f=s("XAI7"),g=s("lIiZ").f,h=s("A+MN")(0),p=s("sjnA");t.exports=function(t,e,s,v,m,b){var I=n[t],_=I,y=m?"set":"add",L=_&&_.prototype,k={};return p&&"function"==typeof _&&(b||L.forEach&&!o(function(){(new _).entries().next()}))?(_=e(function(e,s){l(e,_,t,"_c"),e._c=new I,void 0!=s&&u(s,m,e[y],e)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in L&&(!b||"clear"!=t)&&r(_.prototype,t,function(s,n){if(l(this,_,t),!e&&b&&!d(s))return"get"==t&&void 0;var i=this._c[t](0===s?0:s,n);return e?this:i})}),b||g(_.prototype,"size",{get:function(){return this._c.size}})):(_=v.getConstructor(e,t,m,y),c(_.prototype,s),a.NEED=!0),f(_,t),k[t]=_,i(i.G+i.W+i.F,k),b||v.setStrong(_,t,m),_}},"4pCX":function(t,e){},"A+MN":function(t,e,s){var n=s("WwGG"),i=s("mEMm"),a=s("OXaN"),o=s("CFGK"),r=s("dC2g");t.exports=function(t,e){var s=1==t,c=2==t,u=3==t,l=4==t,d=6==t,f=5==t||d,g=e||r;return function(e,r,h){for(var p,v,m=a(e),b=i(m),I=n(r,h,3),_=o(b.length),y=0,L=s?g(e,_):c?g(e,0):void 0;_>y;y++)if((f||y in b)&&(v=I(p=b[y],y,m),t))if(s)L[y]=v;else if(v)switch(t){case 3:return!0;case 5:return p;case 6:return y;case 2:L.push(p)}else if(l)return!1;return d?-1:u||l?l:L}}},A8UH:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("kfHR"),i=s.n(n),a=s("zsLt"),o=s.n(a),r=s("HzJ8"),c=s.n(r),u=s("FrmM"),l={props:{caseObj:{type:Object,required:!0}},name:"step5",data:function(){return{msg:"step5",tabIndex:1,isSave:!1,closable:!1,fullscreenLoading:!1,currentTabName:"0",dialogVisible:!1,transferVal:[],transferListData:[],editableTabsList:[],suggestionRadioListPre:[],originEditableTabsList:[]}},mounted:function(){var t=this;this.loadData(),window.checkIsSave=function(e,s){t.next(e,s)}},methods:{loadData:function(){var t=this;this.fullscreenLoading=!0,Object(u.e)().then(function(e){if("200"===e.data.code){t.fullscreenLoading=!1,t.suggestionRadioListPre=[];var s=!0,n=!1,i=void 0;try{for(var a,o=c()(e.data.data);!(s=(a=o.next()).done);s=!0){var r=a.value;t.suggestionRadioListPre.push({label:r.optionId,labelName:r.optionContent})}}catch(t){n=!0,i=t}finally{try{!s&&o.return&&o.return()}finally{if(n)throw i}}t.getProcessingOpinion()}else t.fullscreenLoading=!1,t.$message({type:"warning",message:e.data.msg})})},getProcessingOpinion:function(){var t=this;this.fullscreenLoading=!0,Object(u.n)({caseNumber:this.caseObj.caseNumber}).then(function(e){"200"===e.data.code?(t.fullscreenLoading=!1,t.editableTabsList=[],t.originEditableTabsList=e.data.data,e.data.data&&e.data.data.forEach(function(e,s){t.getGistByOptionId(e,s)})):(t.fullscreenLoading=!1,t.$message({type:"warning",message:e.data.msg}))})},getNewRadio:function(t){var e=this;this.isSave=!0,t.contentForm.choosedGistIds="",t.contentForm.suggestionCheckList=[],this.fullscreenLoading=!0,Object(u.k)({optionId:t.contentForm.suggestionRadioVal}).then(function(s){"200"===s.data.code?(e.fullscreenLoading=!1,t.contentForm.suggestionCheckListPreOrigin=s.data.data,t.contentForm.suggestionCheckListPre=s.data.data.map(function(t){return t.gistContent})||""):(e.fullscreenLoading=!1,e.$message({type:"warning",message:s.data.msg}))}),this.fullscreenLoading=!0,Object(u.d)({optionId:t.contentForm.suggestionRadioVal,gistIds:"",suspectInfoId:t.suspectId,caseNumber:this.caseObj.caseNumber}).then(function(s){"200"===s.data.code?(e.fullscreenLoading=!1,t.contentForm.basicInfo=s.data.data):(e.fullscreenLoading=!1,e.$message({type:"warning",message:s.data.msg}))})},checkRow:function(t,e){this.isSave=!0;var s=new o.a(e.contentForm.suggestionCheckList),n=i()(new o.a(e.contentForm.suggestionCheckListPreOrigin.filter(function(t){return s.has(t.gistContent)}))).map(function(t){return t.gistId}).join(",");e.contentForm.choosedGistIds=n,this.generatingConclusion(e)},generatingConclusion:function(t){var e=this;this.isSave=!0,this.fullscreenLoading=!0,Object(u.d)({optionId:t.contentForm.suggestionRadioVal,gistIds:t.contentForm.choosedGistIds,suspectInfoId:t.suspectId,caseNumber:this.caseObj.caseNumber,details:t.contentForm.basicInfo}).then(function(s){if("200"===s.data.code){if(e.fullscreenLoading=!1,!s.data.data)return e.$message({type:"warning",message:"未能生成结论,请手动编辑"}),!1;t.contentForm.basicInfo=s.data.data,e.$message({type:"success",message:"生成结论成功"})}else e.fullscreenLoading=!1,e.$message({type:"warning",message:s.data.msg})})},saveProcessingOpinion:function(t,e,s){var n=this;this.isSave=!1;var i=[],a=!0,o=!1,r=void 0;try{for(var l,d=c()(this.editableTabsList);!(a=(l=d.next()).done);a=!0){var f=l.value;i.push({caseNumber:this.caseObj.caseNumber,choosedGistIds:f.contentForm.choosedGistIds,details:f.contentForm.basicInfo,opinionId:f.opinionId,optionId:f.contentForm.suggestionRadioVal,sort:f.sort,suspectName:f.suspectName,suspectId:f.suspectId,createTime:f.createTime,updateTime:f.updateTime,updateUser:f.updateUser,createUser:localCache.getItem("userId")})}}catch(t){o=!0,r=t}finally{try{!a&&d.return&&d.return()}finally{if(o)throw r}}Object(u.s)(i).then(function(i){"200"===i.data.code?("isMergingProcessing"===t?(n.$message({type:"success",message:"自动保存成功,可进行合并处理"}),n.mergingProcessing()):n.$message({type:"success",message:"保存成功"}),s?eDossier&&eDossier.close():e&&n.$router.push({path:e})):n.$message({type:"warning",message:i.data.msg})})},getGistByOptionId:function(t,e){var s=this,n=t.optionId||this.suggestionRadioListPre[0].label;Object(u.k)({optionId:n}).then(function(i){"200"===i.data.code?s.generateConclusion(i.data.data,t,e,n):s.$message({type:"warning",message:i.data.msg})})},generateConclusion:function(t,e,s,n){var a=this;Object(u.d)({optionId:n,gistIds:e.choosedGistIds,suspectInfoId:e.suspectId,caseNumber:this.caseObj.caseNumber}).then(function(s){var n=[];if(e.choosedGistIds){var r=e.choosedGistIds.split(","),c=new o.a(r);n=i()(new o.a(t.filter(function(t){return c.has(t.gistId+"")}))).map(function(t){return t.gistContent})}var u=!0;a.editableTabsList.forEach(function(s,i){s.suspectId===e.suspectId&&(u=!1,a.editableTabsList[i].contentForm={suggestionRadioVal:e.optionId,suggestionRadioListPre:a.suggestionRadioListPre,suggestionCheckListPreOrigin:t,suggestionCheckListPre:t.map(function(t){return t.gistContent})||"",choosedGistIds:e.choosedGistIds,suggestionCheckList:n||[],basicInfo:e.details})}),u&&(a.editableTabsList.push({title:e.suspectName,name:e.suspectName,suspectId:e.suspectId,opinionId:e.opinionId,suspectName:e.suspectName,createTime:e.createTime,updateTime:e.updateTime,updateUser:e.updateUser,sort:e.sort,contentForm:{suggestionRadioVal:e.optionId||a.suggestionRadioListPre[0].label,suggestionRadioListPre:a.suggestionRadioListPre,suggestionCheckListPreOrigin:t,suggestionCheckListPre:t.map(function(t){return t.gistContent})||"",choosedGistIds:e.choosedGistIds,suggestionCheckList:n||[],basicInfo:e.details?e.details:s.data.data}}),a.editableTabsList.sort(a.compare))})},compare:function(t,e){var s=t.sort,n=e.sort;return s<n?-1:s>n?1:0},next:function(t,e){this.isSaves("step6",t,e)},isSaves:function(t,e,s){var n=this;this.isSave?this.$confirm("有修改的嫌疑人信息未保存, 是否保存?","",{confirmButtonText:"保存",cancelButtonText:"取消",center:!0,closeOnClickModal:!1,showClose:!1}).then(function(){n.saveProcessingOpinion("",e,s)}).catch(function(i){n.$message({type:"info",message:"已取消保存"}),s?eDossier&&eDossier.close():e?n.$router.push({path:e}):n.$router.push({name:t})}):s?eDossier&&eDossier.close():e?this.$router.push({path:e}):this.$router.push({name:t})},prev:function(){this.isSaves("step4")},mergingProcessing:function(){this.transferListData=[];var t=!0,e=!1,s=void 0;try{for(var n,i=c()(this.editableTabsList);!(t=(n=i.next()).done);t=!0){var a=n.value;this.editableTabsList[this.currentTabName].suspectId!==a.suspectId&&this.transferListData.push({key:a.suspectId,label:a.title,disabled:!1})}}catch(t){e=!0,s=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw s}}this.dialogVisible=!0},changeBasicInfo:function(){this.isSave=!0},getMergingProcessing:function(){var t=this;this.transferVal&&(this.dialogVisible=!1,this.isSave=!0,Object(u.q)({sourceSuspectInfoId:this.editableTabsList[this.currentTabName].suspectId+"",destSuspectInfoIds:this.transferVal.join(","),caseNumber:this.caseObj.caseNumber}).then(function(e){"200"===e.data.code?(t.$message({type:"success",message:"合并成功"}),t.transferVal=[],e.data.data&&e.data.data.forEach(function(e,s){t.getGistByOptionId(e,s)})):t.$message({type:"warning",message:e.data.msg})}))},handleClose:function(t){this.transferVal=[],t()}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fullscreenLoading,expression:"fullscreenLoading"}],staticClass:"step-wrap step5-css"},[t.editableTabsList.length>0?s("el-tabs",{staticClass:"el-tabs-css",attrs:{closable:t.closable},model:{value:t.currentTabName,callback:function(e){t.currentTabName=e},expression:"currentTabName"}},t._l(t.editableTabsList,function(e){return s("el-tab-pane",{key:e.sort,attrs:{label:e.title}},[s("div",{staticClass:"step-body-wrap step-body-wrap-step5"},[s("el-form",{ref:"form",refInFor:!0,attrs:{model:e.contentForm}},[s("div",{staticClass:"h3-title"},[t._v("处理意见")]),t._v(" "),s("el-row",{staticClass:"block-wrap"},t._l(e.contentForm.suggestionRadioListPre,function(n){return s("el-col",{key:n.label,staticClass:"item-wrap",attrs:{span:6}},[s("el-radio",{attrs:{label:n.label,title:n.labelName},on:{change:function(s){t.getNewRadio(e)}},model:{value:e.contentForm.suggestionRadioVal,callback:function(s){t.$set(e.contentForm,"suggestionRadioVal",s)},expression:"item.contentForm.suggestionRadioVal"}},[t._v(t._s(n.labelName))])],1)})),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.suggestionCheckListPre.length>0,expression:"item.contentForm.suggestionCheckListPre.length>0"}],staticClass:"h3-title"},[t._v("处理意见依据")]),t._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.suggestionCheckListPre.length>0,expression:"item.contentForm.suggestionCheckListPre.length>0"}],staticClass:"block-wrap step-5-checkbox"},[s("el-checkbox-group",{model:{value:e.contentForm.suggestionCheckList,callback:function(s){t.$set(e.contentForm,"suggestionCheckList",s)},expression:"item.contentForm.suggestionCheckList"}},t._l(e.contentForm.suggestionCheckListPre,function(n){return s("el-col",{key:n,staticClass:"item-wrap",attrs:{span:12}},[s("el-checkbox",{key:n,attrs:{title:n,label:n},on:{change:function(s){return t.checkRow(s,e)}},model:{value:e.contentForm.suggestionRadioVal,callback:function(s){t.$set(e.contentForm,"suggestionRadioVal",s)},expression:"item.contentForm.suggestionRadioVal"}})],1)}))],1),t._v(" "),s("div",{staticClass:"h3-title generatingConclusion-title"},[s("span",{staticClass:"generatingConclusion-text"},[t._v("最终结论")])]),t._v(" "),s("el-row",{staticClass:"block-wrap"},[s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{type:"textarea",maxlength:"2048",rows:"10"},on:{change:t.changeBasicInfo},model:{value:e.contentForm.basicInfo,callback:function(s){t.$set(e.contentForm,"basicInfo",s)},expression:"item.contentForm.basicInfo"}})],1)],1)],1)],1)])})):t._e(),t._v(" "),t.editableTabsList.length>0?s("el-button",{staticClass:"addBtn",attrs:{size:"small",type:"primary",disabled:t.editableTabsList.length<=1},on:{click:function(e){t.saveProcessingOpinion("isMergingProcessing")}}},[t._v("合并处理")]):t._e(),t._v(" "),s("div",{staticClass:"step-footer-wrap"},[t.editableTabsList.length>0?s("el-button",{attrs:{size:"small"},on:{click:function(e){t.saveProcessingOpinion("")}}},[t._v("保存")]):t._e(),t._v(" "),s("el-button",{attrs:{size:"small"},on:{click:t.prev}},[t._v("上一步")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.next()}}},[t._v("下一步")])],1),t._v(" "),0===t.editableTabsList.length?s("div",{staticClass:"step5-no-result"},[t._m(0)]):t._e(),t._v(" "),s("el-dialog",{attrs:{visible:t.dialogVisible,width:"580px",center:"","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("div",{staticClass:"yofc-dialog-header",attrs:{slot:"title"},slot:"title"},[s("h1",[t._v("合并处理")])]),t._v(" "),t.dialogVisible?s("div",{staticClass:"yofc-transfer"},[s("el-transfer",{attrs:{titles:["可合并处理的嫌疑人","已选择"],data:t.transferListData},model:{value:t.transferVal,callback:function(e){t.transferVal=e},expression:"transferVal"}})],1):t._e(),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1,t.transferVal=[]}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary",disabled:t.transferVal.length<1},on:{click:function(e){t.getMergingProcessing()}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step5-no-cell"},[e("img",{attrs:{src:s("1yPc"),alt:""}}),this._v(" "),e("p",{staticStyle:{"text-align":"center"}},[this._v("暂无数据！")])])}]};var f=s("C7Lr")(l,d,!1,function(t){s("k6E1"),s("4pCX")},"data-v-2e7465fa",null);e.default=f.exports},DG01:function(t,e,s){s("vyS5")("Set")},MxwP:function(t,e,s){"use strict";var n=s("lIiZ").f,i=s("c1o2"),a=s("bodH"),o=s("WwGG"),r=s("t8DS"),c=s("k/7E"),u=s("uH+j"),l=s("z7iO"),d=s("4BpY"),f=s("sjnA"),g=s("DVkV").fastKey,h=s("27tL"),p=f?"_s":"size",v=function(t,e){var s,n=g(e);if("F"!==n)return t._i[n];for(s=t._f;s;s=s.n)if(s.k==e)return s};t.exports={getConstructor:function(t,e,s,u){var l=t(function(t,n){r(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=n&&c(n,s,t[u],t)});return a(l.prototype,{clear:function(){for(var t=h(this,e),s=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete s[n.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var s=h(this,e),n=v(s,t);if(n){var i=n.n,a=n.p;delete s._i[n.i],n.r=!0,a&&(a.n=i),i&&(i.p=a),s._f==n&&(s._f=i),s._l==n&&(s._l=a),s[p]--}return!!n},forEach:function(t){h(this,e);for(var s,n=o(t,arguments.length>1?arguments[1]:void 0,3);s=s?s.n:this._f;)for(n(s.v,s.k,this);s&&s.r;)s=s.p},has:function(t){return!!v(h(this,e),t)}}),f&&n(l.prototype,"size",{get:function(){return h(this,e)[p]}}),l},def:function(t,e,s){var n,i,a=v(t,e);return a?a.v=s:(t._l=a={i:i=g(e,!0),k:e,v:s,p:n=t._l,n:void 0,r:!1},t._f||(t._f=a),n&&(n.n=a),t[p]++,"F"!==i&&(t._i[i]=a)),t},getEntry:v,setStrong:function(t,e,s){u(t,e,function(t,s){this._t=h(t,e),this._k=s,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))},s?"entries":"values",!s,!0),d(e)}}},Oyrx:function(t,e,s){var n=s("adiS"),i=s("vhYp");t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},SMmX:function(t,e,s){"use strict";var n=s("FITv"),i=s("7p3N"),a=s("WwGG"),o=s("k/7E");t.exports=function(t){n(n.S,t,{from:function(t){var e,s,n,r,c=arguments[1];return i(this),(e=void 0!==c)&&i(c),void 0==t?new this:(s=[],e?(n=0,r=a(c,arguments[2],2),o(t,!1,function(t){s.push(r(t,n++))})):o(t,!1,s.push,s),new this(s))}})}},V7Pz:function(t,e,s){var n=s("FITv");n(n.P+n.R,"Set",{toJSON:s("Oyrx")("Set")})},b4tm:function(t,e,s){var n=s("8Nvm"),i=s("JBI7"),a=s("biYF")("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},dC2g:function(t,e,s){var n=s("b4tm");t.exports=function(t,e){return new(n(t))(e)}},k6E1:function(t,e){},kfHR:function(t,e,s){t.exports={default:s("qQfv"),__esModule:!0}},kksE:function(t,e,s){"use strict";var n=s("lIiZ"),i=s("go9Q");t.exports=function(t,e,s){e in t?n.f(t,e,i(0,s)):t[e]=s}},oltR:function(t,e,s){"use strict";var n=s("MxwP"),i=s("27tL");t.exports=s("4HpA")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"Set"),t=0===t?0:t,t)}},n)},qQfv:function(t,e,s){s("IsPG"),s("yrDz"),t.exports=s("AKd3").Array.from},toDE:function(t,e,s){s("SMmX")("Set")},vhYp:function(t,e,s){var n=s("k/7E");t.exports=function(t,e){var s=[];return n(t,!1,s.push,s,e),s}},vyS5:function(t,e,s){"use strict";var n=s("FITv");t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},yrDz:function(t,e,s){"use strict";var n=s("WwGG"),i=s("FITv"),a=s("OXaN"),o=s("kDTw"),r=s("V2W7"),c=s("CFGK"),u=s("kksE"),l=s("YW8S");i(i.S+i.F*!s("75+0")(function(t){Array.from(t)}),"Array",{from:function(t){var e,s,i,d,f=a(t),g="function"==typeof this?this:Array,h=arguments.length,p=h>1?arguments[1]:void 0,v=void 0!==p,m=0,b=l(f);if(v&&(p=n(p,h>2?arguments[2]:void 0,2)),void 0==b||g==Array&&r(b))for(s=new g(e=c(f.length));e>m;m++)u(s,m,v?p(f[m],m):f[m]);else for(d=b.call(f),s=new g;!(i=d.next()).done;m++)u(s,m,v?o(d,p,[i.value,m],!0):i.value);return s.length=m,s}})},zsLt:function(t,e,s){t.exports={default:s("1J5t"),__esModule:!0}}});
//# sourceMappingURL=0.8f8fa05312af3402c803.js.map